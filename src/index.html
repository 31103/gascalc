<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ガス使用量計算ツール</title>
    <!-- TailwindCSS はビルド時にここにインライン展開されます -->
</head>

<body class="bg-gray-100 text-gray-800 font-sans">
    <main class="container mx-auto max-w-3xl p-5">
        <article class="bg-white p-6 md:p-8 rounded-lg shadow-md">
            <header class="flex justify-between items-center mb-6">
                <div class="flex items-center gap-3">
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-700">ガス使用量計算</h1>
                    <div class="relative group">
                        <button id="settingsBtn" class="text-xl text-gray-500 hover:text-blue-600 transition-colors duration-200">
                            ⚙️
                        </button>
                        <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-max max-w-xs px-3 py-1.5 bg-gray-700 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap">
                            設定を開く
                        </span>
                    </div>
                </div>
                <button id="clearAllBtn" class="btn btn-danger text-sm">
                    クリア
                </button>
            </header>

            <!-- 設定画面 (モーダル) -->
            <div id="settingsOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
                <div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-md mx-4">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold text-gray-700">設定</h2>
                        <button id="settingsCloseBtn" class="text-2xl text-gray-500 hover:text-gray-700">&times;</button>
                    </div>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <label for="fio2Mode" class="flex items-center text-sm font-medium text-gray-700 cursor-pointer">
                                FiO2モード
                                <span class="relative group ml-1.5">
                                    <span class="inline-block w-4 h-4 bg-gray-400 text-white text-xs rounded-full text-center leading-4 cursor-help">?</span>
                                    <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-64 px-3 py-1.5 bg-gray-700 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none">
                                        FiO2を指定して計算 (ハイフロー/人工呼吸器用)
                                    </span>
                                </span>
                            </label>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="fio2Mode" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                        <div class="flex items-center justify-between">
                             <label for="noRoomAirMode" class="flex items-center text-sm font-medium text-gray-700 cursor-pointer">
                                室内気不使用
                                <span class="relative group ml-1.5">
                                    <span class="inline-block w-4 h-4 bg-gray-400 text-white text-xs rounded-full text-center leading-4 cursor-help">?</span>
                                    <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-64 px-3 py-1.5 bg-gray-700 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none">
                                        医療ガスのみ使用 (一部の人工呼吸器用)<br>※FiO2モード有効時のみ
                                    </span>
                                </span>
                            </label>
                             <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="noRoomAirMode" class="sr-only peer" disabled>
                                <div class="w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-blue-300 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 peer-disabled:opacity-50 peer-disabled:cursor-not-allowed"></div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div id="error" class="text-red-500 text-sm mb-4"></div>

            <section class="mb-6">
                <h2 class="text-lg font-semibold text-gray-700 mb-2">入力内容</h2>
                <ul id="entries" class="space-y-1 max-h-60 overflow-y-auto border rounded p-2 bg-gray-50">
                    <!-- 入力内容はJSで動的に追加 -->
                    <li class="text-center text-gray-500 text-sm py-4">まだ入力がありません</li>
                </ul>
            </section>

            <section>
                <h2 class="text-lg font-semibold text-gray-700 mb-2">ガス使用量 (日別)</h2>
                <ul id="usage" class="space-y-1 border rounded p-2 bg-gray-50 min-h-[50px]">
                    <!-- 計算結果はJSで動的に追加 -->
                     <li class="text-center text-gray-500 text-sm py-4">入力後に計算結果が表示されます</li>
                </ul>
            </section>
        </article>
    </main>

    <!-- フッター入力エリア -->
    <footer class="fixed bottom-0 left-0 right-0 bg-white p-4 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] border-t">
        <div class="container mx-auto max-w-3xl">
            <div class="flex flex-wrap items-end gap-3">
                <div class="flex-grow sm:flex-grow-0">
                    <label for="dateTime" class="block text-xs font-medium text-gray-600 mb-1 flex items-center">
                        日付時刻
                        <span class="relative group ml-1">
                            <span class="inline-block w-3.5 h-3.5 bg-gray-400 text-white text-[10px] rounded-full text-center leading-tight cursor-help">?</span>
                            <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-max max-w-xs px-2 py-1 bg-gray-700 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-normal">
                                例: 2日9時7分 → 20907<br>日付省略可 (直近を継承)<br>順不同入力可
                            </span>
                        </span>
                    </label>
                    <input type="text" id="dateTime" placeholder="DDHHMM" class="input-field w-full sm:w-28">
                </div>
                <div class="flex-grow sm:flex-grow-0">
                    <label for="flow" class="block text-xs font-medium text-gray-600 mb-1 flex items-center">
                        流量(L/min)
                         <span class="relative group ml-1">
                            <span class="inline-block w-3.5 h-3.5 bg-gray-400 text-white text-[10px] rounded-full text-center leading-tight cursor-help">?</span>
                            <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-max max-w-xs px-2 py-1 bg-gray-700 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-normal">
                                例: 酸素1.5L → 1.5<br>人工呼吸器 → 分時換気量
                            </span>
                        </span>
                    </label>
                    <input type="text" id="flow" placeholder="例: 3" class="input-field w-full sm:w-20">
                </div>
                <div class="flex-grow sm:flex-grow-0 hidden" id="fio2InputGroup"> <!-- 初期状態は非表示 -->
                    <label for="fio2Input" class="block text-xs font-medium text-gray-600 mb-1 flex items-center">
                        FiO2(%)
                         <span class="relative group ml-1">
                            <span class="inline-block w-3.5 h-3.5 bg-gray-400 text-white text-[10px] rounded-full text-center leading-tight cursor-help">?</span>
                            <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-max max-w-xs px-2 py-1 bg-gray-700 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-normal">
                                酸素濃度 (21-100の整数)
                            </span>
                        </span>
                    </label>
                    <input type="text" id="fio2Input" placeholder="例: 40" class="input-field w-full sm:w-20">
                </div>
                <button id="addEntryBtn" class="btn btn-primary text-sm w-full sm:w-auto px-5">
                    追加
                </button>
            </div>
        </div>
    </footer>

    <!-- JavaScript はビルド時にここにインライン展開されます -->
</body>

</html>
